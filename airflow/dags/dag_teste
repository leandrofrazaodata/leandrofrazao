import os
from datetime import datetime

from airflow.decorators import dag, task
from airflow.models import Variable
from airflow.operators.python import PythonVirtualenvOperator
from airflow.sensors.external_task import ExternalTaskSensor


@dag(
    dag_id="dag_teste",
    default_args={
        "owner": "plataforma-dados-alloha",
        "depends_on_past": False,
        "email_on_failure": False,
        "email_on_retry": False,
        "retries": 1,
    },
    schedule_interval=None,
    start_date=datetime(
        datetime.today().year, datetime.today().month, datetime.today().day
    ),
    on_failure_callback=notify_teams,
    catchup=False,
    max_active_runs=2,
    concurrency=4,
    tags=["dbt", "teste"]
)